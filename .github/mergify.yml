queue_rules:
  - name: default
    conditions: []

pull_request_rules:
  - name: åˆå¹¶ååˆ é™¤åˆ†æ”¯
    conditions:
      - merged
    actions:
      delete_head_branch:

  - name: ç§»é™¤è¿‡æ—¶çš„å®¡æŸ¥è¯„è®º
    conditions:
      - author!=A-kirami
    actions:
      dismiss_reviews:

  - name: å‘å¸ƒ PR æ—¶åˆ†é…å—ç†äºº
    conditions:
      - -merged
      - -closed
      - -author~=^.*\[bot\]$
    actions:
      assign:
        add_users:
          - A-kirami

  - name: CI ä»£ç æµ‹è¯•é€šè¿‡æ—¶è¯·æ±‚å®¡æŸ¥
    conditions:
      - -merged
      - -closed
      - check-success=CodeTests
      - -author=A-kirami
      - -author~=^.*\[bot\]$
    actions:
      request_reviews:
        users:
          - A-kirami

  - name: CI ä»£ç æµ‹è¯•å¤±è´¥
    conditions:
      - check-failure=CodeTests
    actions:
      comment:
          message: "@{{author}} è¿™ä¸ªæ‹‰å–è¯·æ±‚æœªé€šè¿‡ä»£ç æµ‹è¯•, è¯·æŸ¥çœ‹çŠ¶æ€æ£€æŸ¥ä¸­çš„è¯¦ç»†æŠ¥å‘Šå¹¶ä¿®å¤é—®é¢˜"

  - name: CI æµ‹è¯•è¦†ç›–ç‡å¤±è´¥
    conditions:
      - or:
        - "check-failure=DeepSource: Test coverage"
        - "check-failure=Codacy Coverage Report"
        - check-failure~=^codecov\/.*
    actions:
        comment:
          message: "@{{author}} åˆå¹¶è¿™ä¸ªæ‹‰å–è¯·æ±‚å°†ä¼šå¯¼è‡´ä»£ç è¦†ç›–ç‡ä¸‹é™, è¯·æŸ¥çœ‹çŠ¶æ€æ£€æŸ¥ä¸­çš„è¯¦ç»†æŠ¥å‘Šå¹¶è¡¥å……æµ‹è¯•"

  - name: CI é™æ€åˆ†æå¤±è´¥
    conditions:
      - or:
        - "check-failure=DeepSource: Python"
        - "check-failure=Codacy Static Code Analysis "
    actions:
        comment:
          message: "@{{author}} è¿™ä¸ªæ‹‰å–è¯·æ±‚ä¸­å­˜åœ¨ä»£ç è´¨é‡é—®é¢˜, è¯·æŸ¥çœ‹çŠ¶æ€æ£€æŸ¥ä¸­çš„è¯¦ç»†æŠ¥å‘Šå¹¶ä¿®å¤é—®é¢˜"

  - name: æ‰¹å‡†æ‰€æœ‰è€…çš„ä¸€åˆ‡æ›´æ”¹
    conditions:
      - author=A-kirami
    actions:
      review:
        type: APPROVE

  - name: å®¡æŸ¥é€šè¿‡ååŠ å…¥åˆå¹¶é˜Ÿåˆ—
    conditions:
      - "#approved-reviews-by>=1"
      - "#review-requested=0"
      - "#changes-requested-reviews-by=0"
      - check-success=CodeTests
      - or:
        - author=A-kirami
        - and:
          - author!=A-kirami
          - approved-reviews-by=A-kirami
    actions:
      queue:
        name: default
        method: squash

  - name: åœ¨ PR æ„å¤–å–æ¶ˆæ’é˜Ÿæ—¶é€šçŸ¥
    conditions:
      - 'check-failure=Queue: Embarked in merge train'
    actions:
      comment:
        message: >
          @{{ author }}ï¼Œæ­¤è¯·æ±‚æœªèƒ½åˆå¹¶ï¼Œå·²ä»åˆå¹¶é˜Ÿåˆ—ä¸­é€€å‡ºã€‚
          å¦‚æœæ‚¨è®¤ä¸ºæ‚¨çš„ PR åœ¨åˆå¹¶é˜Ÿåˆ—ä¸­å¤±è´¥æ˜¯å› ä¸ºå¥‡æ€ªçš„æµ‹è¯•ï¼Œå¯ä»¥é€šè¿‡è¯„è®º'@mergifyio requeue'æ¥é‡æ–°æ’é˜Ÿã€‚
          æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨ "Queue: Embarked in merge train" æ£€æŸ¥è¿è¡Œä¸­æ‰¾åˆ°ã€‚

  - name: è¦æ±‚è§£å†³å†²çª
    conditions:
      - conflict
    actions:
        comment:
          message: "@{{author}} è¿™ä¸ª PR ä¸­å‘ç”Ÿäº†å†²çª, è¯·è§£å†³æ­¤å†²çª"
        label:
          add:
            - conflict

  - name: è§£å†³å†²çªåç§»é™¤ conflict æ ‡ç­¾
    conditions:
      - -conflict
    actions:
      label:
        remove:
          - conflict

  # - name: æ¬¢è¿åˆæ¬¡è´¡çŒ®
  #   conditions:
  #     - author!=@regularcontributors
  #   actions:
  #       comment:
  #         message: |
  #             ğŸ‘‹ æ¬¢è¿æ¥åˆ°è¿™ä¸ªé¡¹ç›®!
  #             æˆ‘ä»¬å¾ˆé«˜å…´ä½ èƒ½æˆä¸ºæˆ‘ä»¬ä¸­çš„ä¸€å‘˜ ğŸ’˜
  #             å¦‚æœè¿™æ˜¯ä½ çš„ç¬¬ä¸€æ¬¡ PR è´¡çŒ®, è¯·æŸ¥çœ‹æ­¤æ–‡æ¡£äº†è§£æˆ‘ä»¬çš„å¤„ç†æµç¨‹

  - name: åˆå¹¶åæ„Ÿè°¢è´¡çŒ®è€…
    conditions:
      - merged
      - -author=A-kirami
      - -author~=^.*\[bot\]$
    actions:
      comment:
        message: "@{{author}} æ­¤ PR å·²åˆå¹¶, æ„Ÿè°¢ä½ åšå‡ºçš„è´¡çŒ®!"

  - name: è‡ªåŠ¨æ‰¹å‡†æ¥è‡ª Bot çš„æ‹‰å–è¯·æ±‚
    conditions:
      - author~=^.*\[bot\]$
      - check-success=CodeTests
    actions:
      queue:
        name: default
        method: squash
